apply plugin: 'com.android.application'

apply plugin: 'kotlin-android'

apply plugin: 'kotlin-android-extensions'

apply plugin: 'com.google.firebase.appdistribution'

apply plugin: 'com.google.gms.google-services'

apply plugin: 'kotlin-kapt'

apply plugin: 'io.fabric'

apply plugin: "androidx.navigation.safeargs.kotlin"

android {
    compileSdkVersion 29
    buildToolsVersion "29.0.3"

    defaultConfig {
        applicationId "com.github.kiolk.allmed"
        minSdkVersion 21
        targetSdkVersion 29
        versionCode 1
        versionName "1.0"

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    }

    signingConfigs {
        dev {
            storeFile file("../keys/dev.jks")
            storePassword "all_med-dev-key"
            keyAlias "all_med-dev-key"
            keyPassword "all_med-dev-key"
        }

        prod {
            storeFile file("../keys/prod.jks")
            storePassword "all_med-prod-key"
            keyAlias "all_med-prod-key"
            keyPassword "all_med-prod-key"
        }
    }

    flavorDimensions "version"

    productFlavors {
        dev {
            dimension "version"
            applicationIdSuffix ".dev"
            versionNameSuffix "-dev"
            signingConfig signingConfigs.dev

            buildConfigField "String", "BASE_URL", "\"https://api.github.com\""
        }

        prod {
            dimension "version"
            signingConfig signingConfigs.prod

            buildConfigField "String", "BASE_URL", "\"https://bit.ly/\""
        }
    }

    buildTypes {
        debug {
            minifyEnabled false
            debuggable true
        }

        release {
            minifyEnabled true
            shrinkResources true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }

    androidExtensions {
        experimental = true
    }

    applicationVariants.all { variant ->
        variant.outputs.all {
            outputFileName = "AllMed-${android.defaultConfig.versionName}-v${android.defaultConfig.versionCode}-${variant.name}-${variant.buildType.name}.apk"
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    viewBinding {
        enabled = true
    }
}

dependencies {
    implementation "com.crashlytics.sdk.android:crashlytics:2.10.1"

    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation libraries.kotlinStdLib
    implementation libraries.appCompat
    implementation libraries.constraintLayout
    implementation libraries.recyclerView

    implementation libraries.coreKtx
    implementation libraries.coreX
    implementation 'androidx.legacy:legacy-support-v4:1.0.0'
    androidTestImplementation libraries.coreTestX

    implementation libraries.firebaseAnalytics
    implementation "com.crashlytics.sdk.android:crashlytics:2.10.1"
    implementation libraries.firebaseCloudMessaging

    implementation libraries.timber
    implementation libraries.stecho

    implementation libraries.conductor
    implementation libraries.conductorDialog
    implementation libraries.conductorSupport

    implementation libraries.koinCore
    implementation libraries.koinAndroid
    implementation libraries.koinViewModel
    implementation libraries.koinViewModelX
    testImplementation libraries.koinTest
    androidTestImplementation libraries.koinTest

    implementation libraries.googleMap
    implementation libraries.serviceLocation

    implementation libraries.butterKnife
    kapt libraries.butterKnifeCompiler

    implementation libraries.coroutinesCore
    implementation libraries.coroutinesAndroid
    androidTestImplementation libraries.coroutinesTest
    testImplementation libraries.coroutinesTest

    implementation libraries.lifecycleViewModelKtx
    implementation libraries.lifecycleLiveDataKtx
    implementation libraries.lifecycleRuntime
    kapt libraries.lifecycleCompiler

    implementation libraries.retrofit
    implementation libraries.retrofitConverterGson
    implementation libraries.okhttp
    implementation libraries.okhttpLoggingInterceptor

    implementation libraries.room
    kapt libraries.annotationProcessorRoom
    implementation libraries.roomKtx
    androidTestImplementation libraries.roomTesting

    implementation libraries.glide
    kapt libraries.glideCompiler

    debugImplementation libraries.leakcanary

    testImplementation libraries.junit
    testImplementation libraries.junitExtention
    androidTestImplementation libraries.runner
    androidTestImplementation libraries.espresso

    // Navigation
    implementation libraries.navigationFragment
    implementation libraries.navigationUi
    implementation libraries.navigationTest

    implementation 'com.github.clans:fab:1.6.4'
}
